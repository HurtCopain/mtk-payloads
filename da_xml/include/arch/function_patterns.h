#ifndef ARCH_FUNCTION_PATTERNS_H
#define ARCH_FUNCTION_PATTERNS_H

#include <stdint.h>

#if defined(AARCH64)

static const uint32_t MALLOC_PATTERN[] = {
    0xA9BE7BFD, 0xF9000BF3, 0x910003FD, 0x00000200,
    0x00000000, 0x00000000, 0x00000000, 0xEB08013F
};
static const uint32_t MALLOC_MASK[] = {
    0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0x00FFFF00,
    0x00000000, 0x00000000, 0x00000000, 0xFFFFFFFF
};
#define MALLOC_PLEN (sizeof(MALLOC_PATTERN) / sizeof(MALLOC_PATTERN[0]))

static const uint32_t FREE_PATTERN[] = {
    0xB40000A0, 0xA97F2408
};
static const uint32_t FREE_MASK[] = {
    0xFFFFFFFF, 0xFFFFFFFF
};
#define FREE_PLEN (sizeof(FREE_PATTERN) / sizeof(FREE_PATTERN[0]))

static const uint32_t MXML_GET_NODE_TEXT_PATTERN[] = {
    0xa9bf7bfd, 0x910003fd, 0x00000000, 0xb4000000
};
static const uint32_t MXML_GET_NODE_TEXT_MASK[] = {
    0xffffffff, 0xffffffff, 0x00000000, 0xffff0000
};
#define MXML_GET_NODE_TEXT_PLEN (sizeof(MXML_GET_NODE_TEXT_PATTERN) / sizeof(MXML_GET_NODE_TEXT_PATTERN[0]))

static const uint32_t MXML_LOAD_STRING_PATTERN[] = {
    0xD10300FF, 0xA9007BFD, 0x00000000, 0xA9000000,
    0xA9000000, 0xA9000000, 0xA9000000, 0x00000000, 0x52800028
};
static const uint32_t MXML_LOAD_STRING_MASK[] = {
    0xFFFF00FF, 0xFF00FFFF, 0x00000000, 0xFF000000,
    0xFF000000, 0xFF000000, 0xFF000000, 0x00000000, 0xFFFFFFFF
};
#define MXML_LOAD_STRING_PLEN (sizeof(MXML_LOAD_STRING_PATTERN) / sizeof(MXML_LOAD_STRING_PATTERN[0]))

static const uint32_t REGISTER_MAJOR_COMMAND_V1_PATTERN[] = {
    0xA9BD7BFD, 0xF9000BF5, 0x910003FD, 0xA9024FF4, 0xAA0003F5, 0x52800500
};
static const uint32_t REGISTER_MAJOR_COMMAND_V1_MASK[] = {
    0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF
};
#define REGISTER_MAJOR_COMMAND_V1_PLEN (sizeof(REGISTER_MAJOR_COMMAND_V1_PATTERN) / sizeof(REGISTER_MAJOR_COMMAND_V1_PATTERN[0]))

static const uint32_t REGISTER_MAJOR_COMMAND_V2_PATTERN[] = {
    0xA9BD7BFD, 0xF9000BF5, 0xA9024FF4, 0x910003FD, 0xB4000000, 0xAA0103F4,
    0xB4000001, 0xAA0203F3, 0xB4000002, 0xAA0003F5, 0x52800500
};
static const uint32_t REGISTER_MAJOR_COMMAND_V2_MASK[] = {
    0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFF00001F, 0xFFFFFFFF,
    0xFF00001F, 0xFFFFFFFF, 0xFF00001F, 0xFFFFFFFF, 0xFFFFFFFF
};
#define REGISTER_MAJOR_COMMAND_V2_PLEN (sizeof(REGISTER_MAJOR_COMMAND_V2_PATTERN) / sizeof(REGISTER_MAJOR_COMMAND_V2_PATTERN[0]))

// VIVO
static const uint32_t FP_READ_HOST_FILE_V1_PATTERN[] = {
    0xA9BA7BFD,
    0xA9016FFC,
    0xA90267FA,
    0xA9035FF8,
    0xA90457F6,
    0xA9054FF4,
    0x910003FD,
    0xD1000009,
    0x927AE53F,
    0xB4000000,
};
static const uint32_t FP_READ_HOST_FILE_V1_MASK[] = {
    0xFFFFFFFF,
    0xFFFFFFFF,
    0xFFFFFFFF,
    0xFFFFFFFF,
    0xFFFFFFFF,
    0xFFFFFFFF,
    0xFFFFFFFF,
    0xFFC0001F,
    0xFFFFFFFF,
    0xFF000000,
};
#define FP_READ_HOST_FILE_V1_PLEN (sizeof(FP_READ_HOST_FILE_V1_PATTERN) / sizeof(FP_READ_HOST_FILE_V1_PATTERN[0]))

// PACMAN
// A9BA7BFD d1?????? a9016ffc a90267fa 910003fd a9035ff8 a90457f6 a9054ff4 927ae53f aa04????
static const uint32_t FP_READ_HOST_FILE_V2_PATTERN[] = {
    0xA9BA7BFD,
    0xD1000009,
    0xA9016FFC,
    0xA90267FA,
    0x910003FD,
    0xA9035FF8,
    0xA90457F6,
    0xA9054FF4,
    0x927AE53F,
    0xAA040000,
    0xAA000000
};
static const uint32_t FP_READ_HOST_FILE_V2_MASK[] = {
    0xFFFFFFFF,
    0xFFC0001F,
    0xFFFFFFFF,
    0xFFFFFFFF,
    0xFFFFFFFF,
    0xFFFFFFFF,
    0xFFFFFFFF,
    0xFFFFFFFF,
    0xFFFFFFFF,
    0xFFFF0000,
    0xFF000000
};
#define FP_READ_HOST_FILE_V2_PLEN (sizeof(FP_READ_HOST_FILE_V2_PATTERN) / sizeof(FP_READ_HOST_FILE_V2_PATTERN[0]))

// VIVO
// a9ba7bfd a9016ffc a90267fa a9035ff8 a90457f6 a9054ff4 910003fd d1?????? 927ae53f
static const uint32_t FP_WRITE_HOST_FILE_V1_PATTERN[] = {
    0xA9BA7BFD,
    0xA9016FFC,
    0xA90267FA,
    0xA9035FF8,
    0xA90457F6,
    0xA9054FF4,
    0x910003FD,
    0xD1000009,
    0x927AE53F,
    0xAA000000,
    0x2A000000,
};
static const uint32_t FP_WRITE_HOST_FILE_V1_MASK[] = {
    0xFFFFFFFF,
    0xFFFFFFFF,
    0xFFFFFFFF,
    0xFFFFFFFF,
    0xFFFFFFFF,
    0xFFFFFFFF,
    0xFFFFFFFF,
    0xFFC0001F,
    0xFFFFFFFF,
    0xFF000000,
    0xFF000000,
};
#define FP_WRITE_HOST_FILE_V1_PLEN (sizeof(FP_WRITE_HOST_FILE_V1_PATTERN) / sizeof(FP_WRITE_HOST_FILE_V1_PATTERN[0]))

// a9ba7bfd d1?????? a9016ffc a90267fa 910003fd a9035ff8 a90457f6 a9054ff4 927ae53f aa04???? 2a??????
static const uint32_t FP_WRITE_HOST_FILE_V2_PATTERN[] = {
    0xA9BA7BFD,
    0xD1000009,
    0xA9016FFC,
    0xA90267FA,
    0x910003FD,
    0xA9035FF8,
    0xA90457F6,
    0xA9054FF4,
    0x927AE53F,
    0xAA040000,
    0x2A000000
};
static const uint32_t FP_WRITE_HOST_FILE_V2_MASK[] = {
    0xFFFFFFFF,
    0xFFC0001F,
    0xFFFFFFFF,
    0xFFFFFFFF,
    0xFFFFFFFF,
    0xFFFFFFFF,
    0xFFFFFFFF,
    0xFFFFFFFF,
    0xFFFFFFFF,
    0xFFFF0000,
    0xFF000000
};
#define FP_WRITE_HOST_FILE_V2_PLEN (sizeof(FP_WRITE_HOST_FILE_V2_PATTERN) / sizeof(FP_WRITE_HOST_FILE_V2_PATTERN[0]))

#elif defined(ARM)

static const uint32_t MALLOC_PATTERN[] = {
    0xE3A01000, 0xEAFFF9E5
};
static const uint32_t MALLOC_MASK[] = {
    0xFFFFFFFF, 0xFFFFFFFF
};
#define MALLOC_PLEN (sizeof(MALLOC_PATTERN) / sizeof(MALLOC_PATTERN[0]))

static const uint32_t FREE_PATTERN[] = {
    0xE3500000, 0x012FFF1E, 0xE92D4830
};
static const uint32_t FREE_MASK[] = {
    0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF
};
#define FREE_PLEN (sizeof(FREE_PATTERN) / sizeof(FREE_PATTERN[0]))

static const uint32_t MXML_GET_NODE_TEXT_PATTERN[] = {
    0xE92D4800, 0xE1A0B00D, 0xEB003200
};
static const uint32_t MXML_GET_NODE_TEXT_MASK[] = {
    0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFF00
};
#define MXML_GET_NODE_TEXT_PLEN (sizeof(MXML_GET_NODE_TEXT_PATTERN) / sizeof(MXML_GET_NODE_TEXT_PATTERN[0]))

static const uint32_t MXML_LOAD_STRING_PATTERN[] = {
    0xE92D4FF0, 0xE28DB01C, 0xE24DD04C, 0xE1A09000
};
static const uint32_t MXML_LOAD_STRING_MASK[] = {
    0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF
};
#define MXML_LOAD_STRING_PLEN (sizeof(MXML_LOAD_STRING_PATTERN) / sizeof(MXML_LOAD_STRING_PATTERN[0]))

static const uint32_t REGISTER_MAJOR_COMMAND_V1_PATTERN[] = {
    0xE92D4C70, 0xE28DB010, 0xE1A05000, 0xE3A00014
};
static const uint32_t REGISTER_MAJOR_COMMAND_V1_MASK[] = {
    0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF
};
#define REGISTER_MAJOR_COMMAND_V1_PLEN (sizeof(REGISTER_MAJOR_COMMAND_V1_PATTERN) / sizeof(REGISTER_MAJOR_COMMAND_V1_PATTERN[0]))

static const uint32_t REGISTER_MAJOR_COMMAND_V2_PATTERN[] = { 0 };
static const uint32_t REGISTER_MAJOR_COMMAND_V2_MASK[] = { 0 };
#define REGISTER_MAJOR_COMMAND_V2_PLEN 0

static const uint32_t FP_READ_HOST_FILE_V1_PATTERN[] = {
    0xE92D4FF0, 0xE28DB01C, 0xE24DD0DC, 0xE24DDB01
};
static const uint32_t FP_READ_HOST_FILE_V1_MASK[] = {
    0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF
};
#define FP_READ_HOST_FILE_V1_PLEN (sizeof(FP_READ_HOST_FILE_V1_PATTERN) / sizeof(FP_READ_HOST_FILE_V1_PATTERN[0]))

static const uint32_t FP_READ_HOST_FILE_V2_PATTERN[] = { 0 };
static const uint32_t FP_READ_HOST_FILE_V2_MASK[] = { 0 };
#define FP_READ_HOST_FILE_V2_PLEN 0

static const uint32_t FP_WRITE_HOST_FILE_V1_PATTERN[] = {
    0xE92D4FF0, 0xE28DB01C, 0xE24DD09C, 0xE24DDB01, 0xE7C5D01F, 0xE1A06003
};
static const uint32_t FP_WRITE_HOST_FILE_V1_MASK[] = {
    0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF
};
#define FP_WRITE_HOST_FILE_V1_PLEN (sizeof(FP_WRITE_HOST_FILE_V1_PATTERN) / sizeof(FP_WRITE_HOST_FILE_V1_PATTERN[0]))

static const uint32_t FP_WRITE_HOST_FILE_V2_PATTERN[] = { 0 };
static const uint32_t FP_WRITE_HOST_FILE_V2_MASK[] = { 0 };
#define FP_WRITE_HOST_FILE_V2_PLEN 0


#else
#error "Unsupported architecture"
#endif

#endif
